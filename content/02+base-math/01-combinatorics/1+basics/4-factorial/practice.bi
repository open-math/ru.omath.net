~ recurrent article|factorial-recurrent

@problems
    title: Факториальные вычисления
    level: easy
    shared: "Решите примеры:"
    set:
        -   description: |
                $$ \frac{100!}{99!} $$
            hint: |
                Пользуйтесь рекуррентной [формулой](~recurrent) (иногда ее надо использовать несколько раз подряд), выносите за скобки, сокращайте...
            solution: |
                @math
                    \frac{100!}{99!} = \frac{100\cdot \cancel{99!}}{\cancel{99!}} = 100
            answer: $100$

        -   description: |
                $$ \frac{62! - 61!}{60!} $$
            solution: |
                @math
                    \frac{62! - 61!}{60!} = \frac{62 \cdot 61 \cdot 60! - 61\cdot 60!}{60!} = \frac{\cancel{60!}\cdot(62 \cdot 61 - 61)}{\cancel{60!}} = \\
                    = 62\cdot 61 - 61 = 61\cdot(62 - 1) = 61\cdot 61 = 61^2
            answer: $61^2$

        -   description: |
                $$ \frac{82!}{81!} + \frac{34!}{33!} $$
            solution: |
                @math
                    \frac{82!}{81!} + \frac{34!}{33!} = \frac{82\cdot\cancel{81!}}{\cancel{81!}} + \frac{34\cdot \cancel{33!}}{\cancel{33!}} = 82 + 34 = 116
            answer: $116$

        -   description: |
                $$ \frac{26! + 25!\cdot 4 + 25! \cdot 8}{25!} $$
            solution: |
                @math
                    \frac{26! + 25!\cdot 4 + 25! \cdot 8}{25!} = \frac{26\cdot25! + 25!\cdot 4 + 25!\cdot 8}{25!} = \\
                    = \frac{\cancel{25!}\cdot (26 + 4 + 8)}{\cancel{25!}} = 26 + 4 + 8 = 38
            answer: $38$

        -   description: |
                $$ \frac{18\cdot 20! + 3\cdot 20 \cdot 19!}{21!} $$
            solution: |
                @math
                    \frac{18\cdot 20! + 3\cdot 20 \cdot 19!}{21!} = \frac{18\cdot \cancel{20!} + 3\cdot \cancel{20!}}{\cancel{20!}\cdot 21} = \\
                    = \frac{18 + 3}{21} = \frac{\cancel{21}}{\cancel{21}} = 1
            answer: $1$

        -   generator: generators/calculations
            description: |
                $${{ expression1 }}$$
            answer: |
                ${{ answer1 }}$

        -   generator: generators/calculations
            description: |
                $${{ expression2 }}$$
            answer: |
                ${{ answer2 }}$

        -   generator: generators/calculations
            description: |
                $${{ expression3 }}$$
            answer: |
                ${{ answer3 }}$

        -   generator: generators/calculations
            description: |
                $${{ expression4 }}$$
            answer: |
                ${{ answer4 }}$

        -   generator: generators/calculations
            description: |
                $${{ expression5 }}$$
            answer: |
                ${{ answer5 }}$

@problem
    title: Свойства факториала
    level: easy
    description: |
        Докажите следующие свойства факториала $n!$:

        1. Если $n>1$, то факториал -- четное число.
        2. Если $n>4$, то факториал оканчивается на $0$.
        3. $n^n \geq n! \geq n$
    solution:
        "Свойство 1": |
            Любой факториал $n$, где $n>1$, будет содержать в себе множитель $2$.
            Например:

            $$ 5! = 1\cdot \boxed2\cdot 3\cdot 4\cdot 5 $$

            Если число в качестве множителя содержит двойку, значит это число можно поделить на два.
            А если число можно поделить на два, значит это число четное.

            $\blacksquare$

        "Свойство 2": |
            Любой факториал $n$, где $n>4$, будет содержать в себе множители $2$ и $5$.
            Но $2\cdot 5 = 10$, поэтому любой такой факториал будет как минимум иметь один ноль в конце.

            $\blacksquare$

        "Свойство 3": |
            Начнем с того, что при $n=1$ все знаки неравенства обращаются в знак равно:

            $$ 1!^2 = 1^1 = 1! = 1 $$

            Далее будем рассматривать неравенства считая, что $n>1$.

            ---

            $$ n! \geq n $$

            Слева находится произведение чисел, начиная с самого $n$.
            Это точно больше, чем одинокое $n$ справа.
            Исключение -- при $n=2$ получается равенство.

            $\blacksquare$

            ---

            $$ n^n \geq n! $$

            Распишем выражения слева и справа в виде цепочек умножений:

            $$ n\cdot n \cdot \ldots \cdot n \geq 1\cdot 2\cdot \ldots \cdot n $$

            Количество множителей слева и справа одинаковое.
            Но слева сами числа больше, чем числа справа, поэтому и произведение слева будет больше произведения справа.

            $\blacksquare$

@problems
    title: Понять -- значит упростить
    level: easy
    shared: "Упростите выражения:"
    set:
        -   description: |
                $$ \frac{n!}{(n+1)!} $$
            hint: |
                Пользуйтесь рекуррентной [формулой](~recurrent) (иногда ее надо использовать несколько раз подряд), выносите за скобки, сокращайте...
            solution: |
                $$ \frac{n!}{(n+1)!} = \frac{n!}{n!\cdot(n+1)} = \frac{1}{n+1} $$
            answer: |
                $$ \frac{1}{n+1} $$

        -   description: |
                $$ \frac{n!}{(n-2)!} $$
            solution: |
                $$ \frac{n!}{(n-2)!} = \frac{(n-1)!\cdot n}{(n-2)!} = \frac{(n-2)!\cdot(n-1)\cdot n}{(n-2)!} = n\cdot(n-1) = n^{\underline{2}} $$
            answer: |
                $$ n^{\underline{2}} $$

        -   description: |
                $$ \frac{(n+1)!}{(n-2)!} $$
            solution: |
                $$ \frac{(n+1)!}{(n-2)!} = \frac{(n-2)!\cdot(n-1)\cdot n \cdot(n+1)}{(n-2)!} = (n+1)\cdot n \cdot (n-1) = (n+1)^{\underline{3}} $$
            answer: |
                $$ (n+1)^{\underline{3}} $$

        -   description: |
                $$ \frac{(n+2)! + (n+1)!}{(n+2)! - (n+1)!} $$
            solution: |
                @math
                    \frac{(n+2)! + (n+1)!}{(n+2)! - (n+1)!} = \frac{(n+2)\cdot(n+1)! + (n+1)!}{(n+2)\cdot(n+1)! - (n+1)!} = \\
                    = \frac{(n+1)!\cdot(n+2+1)}{(n+1)!\cdot (n+2-1)} = \frac{n+3}{n+1}
            answer: |
                $$ \frac{n+3}{n+1} $$

        -   description: |
                $$ \frac{1}{(n+1)!} - \frac{1}{(n+2)!} $$
            solution: |
                @math
                    \frac{1}{(n+1)!} - \frac{1}{(n+2)!} = \frac{(n+2)! - (n+1)!}{(n+1)!\cdot(n+2)!} = \\
                    = \frac{(n+2)\cdot(n+1)! - (n+1)!}{(n+1)!\cdot(n+2)!} = \frac{(n+1)!\cdot(n+2-1)}{(n+1)!\cdot(n+2)!} = \\
                    = \frac{n+1}{(n+2)!} = \frac{n+1}{n!\cdot(n+1)\cdot(n+2)} = \frac{1}{n!\cdot (n+2)}
            answer: |
                $$ \frac{1}{n!\cdot (n+2)} $$

        -   description: |
                $$ \frac{n!}{(n+1)!} - \frac{(n-1)!}{n!} $$
            solution: |
                @math
                    \frac{n!}{(n+1)!} - \frac{(n-1)!}{n!} = \frac{n!}{(n+1)\cdot n!} - \frac{(n-1)!}{n\cdot (n-1)!} = \\
                    = \frac{1}{n+1} - \frac{1}{n} = \frac{n - (n+1)}{(n+1)\cdot n} = -\frac{1}{(n+1)^{\underline{2}}}
            answer: |
                $$ -\frac{1}{(n+1)^{\underline{2}}} $$

        -   description: |
                $$ \frac{n!}{n(n-1)} $$
            answer: |
                $$ (n-2)! $$

        -   description: |
                $$ \frac{(2n)!}{n!} $$
            answer: |
                $$ (2n)^{\underline{n}} $$

        -   description: |
                $$ \frac{(n+3)!}{(n+1)!(n^2 - 4)} $$
            answer: |
                $$ \frac{n+3}{n-2} $$

        -   description: |
                $$ \frac{1}{n!} - \frac{1}{(n-1)!} - \frac{1}{(n-2)!} $$
            answer: |
                $$ \frac{1-n^2}{n!} $$

        -   description: |
                $$ \frac{4-n^2}{(n+2)!} - \frac{3}{(n+1)!} + \frac{1}{n!} $$
            answer: |
                $$ 0 $$

        -   description: |
                $$ \frac{(n-1)!}{(n+1)!} + \frac{(3n+3)!}{(3n+4)!} $$
            answer: |
                $$ \frac{(n+2)^2}{n(n+1)(3n+4)} $$

        -   description: |
                $$ \frac{(n+1)!}{(n-2)!} - 4\frac{(n+1)!}{(n-1)!} + 9\frac{n!}{(n-1)!} $$
            answer: |
                $$ n(n-2)^2 $$

        -   description: |
                $$ n[n!+(n-1)!] + n^2(n-1)! + (n+1)! $$
            answer: |
                $$ (3n+2)n! $$

        -   description: |
                $$ \frac{n!}{(n-3)!} + \frac{(n+1)!}{(n-2)!} + \frac{(n+2)!}{(n-1)!} - (n^2 + 4) $$
            answer: |
                $$ 3n^3 - n^2 + 3n - 4 $$

        -   description: |
                $$ \frac{1-n}{(n+1)!} + \frac{1}{(n-1)!} $$
            answer: |
                $$ \frac{n^2+1}{(n+1)!} $$

        -   description: |
                $$ \frac{n+2}{n!} - \frac{3n + 1}{(n+1)!} $$
            answer: |
                $$ \frac{n^2 + 1}{(n+1)!} $$

        -   description: |
                $$ \frac{n!}{(n-3)!} + \frac{n!}{(n-2)!2!} $$
            answer: |
                $$ \frac{n(n-1)(2n-3)}{2} $$

        -   description: |
                $$ \left[ \frac{n}{(n-2)!} - \frac{2}{(n-1)!} \right]\frac{n-1}{n+1} $$
            answer: |
                $$ \frac{1}{(n-3)!} $$

        -   description: |
                $$ \frac{n^2-9}{(n+3)!} + \frac{6}{(n+2)!} - \frac{1}{(n+1)!} $$
            answer: |
                $$ \frac{1}{(n+2)!} $$

        -   description: |
                $$ \frac{n!}{(n+1)!} - \frac{(n+1)!}{(n+2)!} - \frac{(n+2)!}{(n+3)!} - \frac{n!}{(n+3)!} $$
            answer: |
                $$ -\frac{n}{(n+1)(n+3)} $$

@problems
    title: Уравнения с факториалами
    level: easy
    shared: "Решите уравнения:"
    set:
        -   description: |
                $$ \frac{(x+6)!}{(x+4)!} + x^2 - 16x = 28 $$
            hint: |
                Пользуйтесь рекуррентной [формулой](~recurrent) и сокращайте.
            solution: |
                @math
                    \frac{(x+6)!}{(x+4)!} + x^2 - 16x = 28

                В числители дроби слева дважды используем рекуррентную [формулу](~recurrent) факториала, что дает нам возможность провести сокращение:

                @math
                    \frac{\cancel{(x+4)!}(x+5)(x+6)}{\cancel{(x+4)!}} + x^2 - 16x = 28
                    \\
                    x^2 + 6x + 5x + 30 + x^2 - 16x - 28 = 0
                    \\
                    2x^2 -5x + 2 = 0

                Решая это квадратное уравнение находим два корня уравнения:

                $$ \boxed{x=2} \qquad \boxed{x=\frac{1}{2}} $$
            answer: |
                $$ x\in\set{2,\frac{1}{2}} $$

        -   description: |
                $$ \frac{(2n+1)!}{(2n)!} + \frac{(3n)!}{(3n-1)!} = \frac{(n+1)!}{2n!} + 50 $$
            solution: |
                $$ \frac{(2n+1)!}{(2n)!} + \frac{(3n)!}{(3n-1)!} = \frac{(n+1)!}{2n!} + 50 $$

                Во всех дробях пользуемся рекуррентной формулой и проводим сокращение:

                @math
                    \frac{\cancel{(2n)!}(2n+1)}{\cancel{(2n)!}} + \frac{\cancel{(3n-1)!}\cdot 3n}{\cancel{(3n-1)!}} = \frac{\cancel{n!}\cdot (n+1)}{2\cancel{n!}} + 50
                    \\
                    2n+1 + 3n = \frac{n+1}{2}+50 \quad
                    \\
                    10n + 2 = n+1 + 100
                    \\
                    9n = 99
                    \\
                    \boxed{n = 11}
            answer: $n = 11$

        -   description: |
                $$ (x!)^2 + 6 = 7x! $$
            hint: |
                Проведите замену переменной.
            solution: |
                @math
                    (x!)^2 + 6 = 7x!

                Введем обозначение $x! = t$ и получаем обычное квадратное уравнение:

                $$ t^2 + 6 = 7t \\ t^2 - 7t + 6 = 0 \\ t = 6 \qquad t = 1 $$

                Возвращаемся к исходным обозначениям:

                $$ x! = 6 \qquad x! = 1 $$

                Чиcло $6$ дает только $3!$, а вот единицу можно получить двумя способами: $1! = 1$ и $0! = 1$.
                Мы нашли все корни уравнения:

                $$ x \in \set{0, 1, 3} $$
            answer: $x \in \set{0, 1, 3}$

        -   description: |
                $$ \frac{1}{8!} + \frac{1}{9!} = \frac{x}{10!} $$
            solution: |
                $$ \frac{1}{8!} + \frac{1}{9!} = \frac{x}{10!} $$

                Обе части уравнения умножаем на $10!$, пользуемся рекуррентной формулой и проводим сокращения:

                @math
                    \frac{10!}{8!} + \frac{10!}{9!} = \frac{10!\cdot x}{10!}
                    \\
                    \frac{\cancel{8!}\cdot 9\cdot 10}{\cancel{8!}} + \frac{\cancel{9!}\cdot 10}{\cancel{9!}} = \frac{\cancel{10!}\cdot x}{\cancel{10!}}
                    \\
                    90 + 10 = x
                    \\
                    \boxed{100 = x}
            answer: $x = 100$

@problem
    title: Удвоение факториала
    level: easy
    description: |
        Существует ли факториалы, которые в $2$ раза больше другого факториала?\
        А в $k$ раз больше?
    hints:
        - |
            Представьте два факториала в виде уравнения:

            $$ m! = 2\cdot n! $$

        - |
            Приведите это уравнение к виду:

            $$ \frac{m!}{n!} = 2 $$
    solution:
        "": |
            Если перевести условие первого вопроса на язык математики, то от нас требуется решить следующее уравнение:

            $$ m! = 2\cdot n! $$

            Поделим обе части уравнения на $n!$:

            $$ \frac{m!}{n!} = 2 $$

            Так становится уже сильно проще. Любые совпадающие множители у факториалов $n!$ и $m!$ будут сокращаться друг с другом.
            Например:

            $$ \frac{9!}{5!} = \frac{\cancel{1\cdot 2\cdot 3\cdot 4\cdot 5}\cdot 6\cdot 7\cdot 8\cdot 9}{\cancel{1\cdot 2\cdot 3\cdot 4\cdot 5}} $$

            Единственный выход -- чтобы факториал сверху имел ровно на один множитель больше и этот множитель может равняться только двум.

            $$ \frac{1\cdot 2}{1} = \frac{2!}{1!} = 2 $$

            Итак, существует только один факториал, который в два раза больше другого: $2!$ в два раза больше $1!$.

        "Общее решение": |

            Тут логика точно такая же. Так как все совпадающие множители сокращаются, единственный выход -- чтобы у верхнего факториала был на $1$ множитель больше и этот множитель равнялся $k$.

            Итак, существует только один факториал, который в $k$ раз больше другого: $k!$ в $k$ раз больше $(k-1)!$.
    answer: |
        Существует только один факториал, который в $k$ раз больше другого: $k!$ в $k$ раз больше $(k-1)!$.
        Следовательно, $2!$ в $2$ раза больше $1!$.

{ #diff }
@problem
    title: Разность соседних факториалов
    level: easy
    description: |
        Найдите, чему равна разность факториалов двух соседних чисел:

        $$ (n+1)! - n! = \ ? $$
    hint: |
        Воспользуйтесь рекуррентной [формулой](~recurrent) факториала.
    solution: |
        Для $(n+1)!$ воспользуемся рекуррентной формулой факториала:

        $$ (n+1)! - n! = n!\cdot(n+1) - n! = \ldots $$

        Вынесем за скобки $n!$ и проведем упрощение:

        $$ \ldots = n!((n+1) - 1) = n!\cdot n $$

        Убираем все промежуточные действия и получаем итоговую формулу:

        $$ (n+1)! - n! = n\cdot n! $$
    answer: |
        $$ n\cdot n! $$

@problem
    title: Разложение факториала
    level: medium
    description: |
        Докажите формулу факториала через два предыдущих факториала:

        $$ n! = \left[ (n-1)! + (n-2)! \right]\cdot(n-1) $$
    hint: |
        Пользуйтесь рекуррентной [формулой](~recurrent) факториала.
    solution: |
        Работать будем только с правой частью.
        Раскроем скобки:

        @math
            n! = (n-1)(n-1)! + (n-1)(n-2)!

        Далее для второго слагаемого воспользуемся рекуррентной [формулой](~recurrent):

        $$ n! = (n-1)(n-1)! + (n-1)! $$

        Выносим за скобки $(n-1)$:

        @math
            n! = (n-1)!(n-1 + 1)
            \\
            n! = (n-1)!\cdot n

        Справа по все той же рекуррентной формуле получается $n!$:

        $$ n! = n! $$

        $\blacksquare$

@problem
    title: Нисходящий поток
    level: medium
    description: |
        Найдите значение выражения:

        $$ \frac{(10! + 9!)(8!+7!)(6!+5!)(4! + 3!)(2! + 1!)}{(10!-9!)(8!-7!)(6!-5!)(4!-3!)(2!-1!)} $$
    hint: |
        Для каждой скобки воспользуйтесь рекуррентной [формулой](~recurrent).
    solution: |
        Любой множитель в выражении можно представить в виде:

        $$ k! \pm (k-1)! $$

        Левое слагаемое разложим по рекуррентной [формуле](~recurrent) и вынесем за скобки одинаковые части:

        @math
            k\cdot(k-1)! \pm (k-1)!
            \\
            (k-1)!\cdot(k\pm 1)

        С помощью полученной формулы заменим все множители в исходном выражении:

        @math
            \frac{11\cdot 9!}{9\cdot 9!} \cdot \frac{9\cdot 7!}{7\cdot 7!} \cdot \frac{7\cdot 5!}{5\cdot 5!} \cdot \frac{5\cdot 3!}{3\cdot 3!} \cdot \frac{3\cdot 1!}{1\cdot 1!}

        Сокращаем одинаковые факториалы:

        @math
            \frac{11}{9}\cdot\frac{9}{7}\cdot\frac{7}{5}\cdot\frac{5}{3}\cdot 3

        Сокращаем одинаковые числа:

        $$ 11 $$
    answer: $11$
    note: |
        В общем случае:

        $$ \frac{[n!+(n-1)!]\cdot \ldots \cdot (2! + 1!)}{[n!-(n-1)!]\cdot \ldots \cdot (2!-1!)} = n + 1 $$

@problem
    title: Факториальная сумма
    level: medium
    description: |
        Вычислите сумму:

        $$ 1\cdot 1! + 2\cdot 2! + \ldots + n\cdot n! $$
    hint: |
        Воспользуйтесь ответом, полученным в [задаче](diff) про разность факториалов соседних чисел.
    solution: |
        Замечаем, что каждое слагаемое в этой сумме имеет вид $k\cdot k!$.
        А это есть не что иное, как разность факториалов двух соседних чисел, формулу которой мы [уже вывели](diff)!

        $$ k\cdot k! = (k+1)! - k! $$

        Заменим каждое слагаемое в сумме на разность:

        $$ (2! - 1!) + (3! - 2!) + (4! - 3!) + \ldots + ((n+1)! - n!) $$

        Так как от перемены мест слагаемых сумма не меняется, поменяем местами слагаемые в скобках:

        $$ (-1! + 2!) + (-2! + 3!) + (-3! + 4!) + \ldots + (-n! + (n+1)!) $$

        В таком виде сразу видно, что в этой сумме взаимоуничтожаются все слагаемые, кроме $(n+1)!$ и $-1!$:

        $$ -1! + (2! - 2!) + (3! - 3!) + \ldots + (n! - n!) + (n+1)! $$

        Итоговое равенство выглядит так:

        $$ 1\cdot 1! + 2\cdot 2! + \ldots + n\cdot n! = (n+1)! - 1 $$
    answer: |
        $$ (n+1)! - 1 $$

@problem
    title: Факториал внутри факториала
    level: medium
    description: |
        Найдите, при каких $n$ выполняется равенство:

        $$ (n!)! = n!\cdot (n-1)! $$
    hint: |
        Факториал от факториала раскладывается в цепочку следующим образом:

        $$ (n!)! = 1\cdot 2\cdot \ldots \cdot n \cdot (n+1) \cdot \ldots \cdot (n! - 1) \cdot n! $$
    solution: |
        Поделим обе части равенства на $n!$:

        $$ \frac{(n!)!}{n!} = (n-1)! $$

        В числителе дроби слева распишем внешний факториал по [определению](article|factorial):

        $$ \frac{1\cdot 2\cdot \ldots \cdot n \cdot (n+1) \cdot \ldots \cdot (n!-1) \cdot \cancel{n!}}{\cancel{n!}} = (n-1)! $$

        $$ (n!-1)! = (n-1)! $$

        Выражения по обе стороны от знака равно теперь практически идентичны.
        Отличаются они только тем, что слева $n!$, а справа $n$.
        Значит, надо найти все варианты $n$, при которых $n! = n$.

        @math
            n! = n
            \\
            1\cdot 2 \cdot \ldots \cdot (n-1) \cdot \cancel{n} = \cancel{n}
            \\
            1\cdot 2 \cdot \ldots \cdot (n-1) = 1
            \\
            (n-1)! = 1

        Факториал можен равнятся единице только если он берется от $0$ или $1$.
        Так мы и получаем искомые ответы:

        $$ n - 1 = 0 \qquad n-1 = 1 \\ \boxed{n = 1} \qquad \boxed{n = 2} $$
    answer: |
        Равенство выполняется только когда $n$ равно $1$ или $2$.

@problem
    title: Бесконечная степень
    level: medium
    description: |
        Решите уравнение:

        $$ x!^{x!^{x!^{\cdots}}} = 1 $$
    hint: |
        Рассмотрите, какими способами можно получить $1$, бесконечно возводя в степень одно и то же число.
    solution: |
        Замечаем, что мы бесконечно возводим в степень **одно и то же** число.
        Есть только один способ получить $1$ через бесконечное возведение в степень одинакового числа, когда это число само равно $1$:

        $$ 1 = 1^{1^{\cdots}} $$

        Значит, $x!$ должен равняться единице.
        Это происходит только в двух вариантах, при $x=0$ и при $x = 1$:

        $$ 0!^{0!^{\cdots}} = 1^{1^{\cdots}} = 1 \\ 1!^{1!^{\cdots}} = 1^{1^{\cdots}} = 1 $$
    answer: |
        Решения два: $0$ и $1$.

{ #factorial-gaps }
@problem
    title: Дырявые факториалы
    level: hard
    description: |
        Среди перечисленных чисел найдите все простые:

        $$ 100! + 2, \quad 100! + 3, \quad \ldots, \quad 100! + 100 $$
    hint: |
        Число является простым, если оно делится только на $1$ и только на само себя.
        Подумайте, а делятся ли числа из списка на что-то еще?
    solution: |
        В общем виде у нас есть некоторое число $n$, причем $2 \leq n \leq 100$.
        С помощью этого $n$ конструируется число из списка в условии:

        $$ 100! + n $$

        Если это число простое, то оно должно делиться только на $1$ и на само себя.
        На $n$ оно делиться нацело не должно.
        Проблема только в том, что оно делится:

        @math
            \frac{100! + n}{n} = \frac{100!}{n} + \frac{n}{n} = \frac{1\cdot 2\cdot \ldots \cancel{n} \cdot \ldots \cdot 100}{\cancel{n}} + 1 \\
            = 1 \cdot 2 \cdot \ldots \cdot (n-1) \cdot (n+1) \cdot \ldots \cdot 99 \cdot 100 + 1

        В результате деления мы получили натуральное число.
        Это означает, что любое число вида $100! + n$ нацело делится на $n$, а значит не является простым.
        Простых чисел среди перечисленных в условии нет.
    answer: Простых чисел среди перечисленных нет.

@problem
    title: Повелитель составных чисел
    level: hard
    description: |
        Докажите, что какое число $n$ не выбери, обязательно найдется ряд из $n$ идущих подряд составных чисел.
    hint: |
        Посмотрите, какие выводы можно сделать из [решения](factorial-gaps) задачи "Дырявые фаториалы".
    solution: |
        В [задаче](factorial-gaps) "Дырявые факториалы" мы показали, что после $100!$ идет как минимум $99$ составных чисел:

        $$ \underbrace{100! + 2}_{1}, \quad \underbrace{100! + 3}_{2}, \quad \ldots, \quad \underbrace{100! + 100}_{100-1 = 99}  $$

        Все рассуждения из той задачи можно повторить для любых чисел.
        Поэтому найти $n$ подряд идущих составных чисел можно сразу после $(n+1)!$:

        $$ \underbrace{(n+1)! + 2}_{1}, \quad \underbrace{(n+1)! + 3}_{2}, \quad \ldots, \quad \underbrace{(n+1)! + n+1}_{(n+1)-1 = n} $$

        $\blacksquare$

@problem
    title: В паре мы сильнее!
    level: hard
    attributes:
        - pretty
    description: |
        Докажите неравенство:

        $$ n!^2 \geq n^n $$
    hint: |
        Распишите обе части неравенства виде цепочек умножений.
        Слева будет две повторяющиеся цепочки.
        Подумайте, какие пары можно составить из элементов этих двух цепочек.
    solution: |
        Распишем выражения слева и справа в виде цепочек произведений.
        Слева повторящиеся множители запишем в две строчки друг под другом:

        @math
            \begin{array}{}
                1\cdot 2\cdot \ldots \cdot (n-1) \cdot n \\
                \times \\
                1 \cdot 2 \cdot \ldots \cdot (n-1) \cdot n
            \end{array}

            \geq

            n\cdot n\cdot \ldots \cdot n

        Перепишем нижний ряд множителей слева в обратном порядке и образуем пары из элемента сверху и снизу в каждом столбце:

        @math
            \begin{array}{c|c|c|c|c|c|c}
                1 & 2 & \ldots & k & \ldots & n-1 & n \\
                n & n-1 & \ldots & n-(k-1) & \ldots & 2 & 1
            \end{array}

            \geq

            n\cdot n\cdot \ldots \cdot n

        @math
            \left[1\cdot n\right]\cdot\ldots\cdot \left[k\cdot(n-(k-1))\right]\cdot\ldots\cdot \left[n\cdot 1\right] \geq n\cdot n\cdot\ldots\cdot n

        Количество множителей слева и справа одинаковое.
        Докажем, что $k$-тый множитель слева будет не меньше соответствующего ему $k$-го множителя справа:

        @math
            k\cdot(n-(k-1)) \geq n
            \\
            k\cdot n - k^2 + k \geq n
            \\
            -k^2 + k + k\cdot n - n \geq 0
            \\
            -k\cdot (k-1) + n\cdot (k-1) \geq 0
            \\
            n - k \geq 0
            \\
            n \geq k

        Последнее очевидно выполняется всегда, ведь номер множителя $k$ не может оказаться больше общего количества множителей $n$.

        А раз каждый множитель слева не меньше каждого множителя справа, то и произведение всех множителей слева будет не меньше произведения всех множителей справа.
        Неравенство доказано.

        $\blacksquare$

@problem
    title: Потрошитель умножений
    level: hard
    description: |
        Докажите неравенство:

        $$ 2!4!\ldots(2n)! > \left[(1+n)!\right]^2, \quad n \geq 2 $$
    hint: |
        Покажите, что каждый множитель слева будет больше соответствующего ему множителя справа.

        Отдельно рассмотрите случай с последними множителями.
        Используйте свободный множитель $2!$ слева, который никак не компенсируется множителем справа.
    solution: |
        Если $n\geq 2$, то можно построить следующую таблицу множителей:

        @math
            \begin{array}{r|}
                \small Номер \ множителя: & 1 & 2 & \ldots & k & \ldots & n & \\
                  \small Левый: & 2! & 4! & \ldots & (2k)! & \ldots & (2n)! & \\
                  \small Правый: & 1^2 & 2^2 & \ldots & k^2 & \ldots & n^2 & (n+1)^2
            \end{array}

        Докажем, что произвольный $k$-ый множитель слева больше соответствующего ему $k$-го множителя справа:

        $$ (2k)! > k^2 $$

        В факториале в левой части точно встретятся множители $k$ и $k+1$, произведение которых будет точно больше, чем $k^2$:

        @math
            \underbrace{\ldots k\cdot (k+1) \ldots}_{(2k)!} > k^2

        Отдельно надо разобраться с самыми последними множителями слева и справа, ведь справа есть один дополнительный множитель -- $(n+1)^2$, для которого нет множителя слева:

        @math
            (2n)! > n^2\cdot(n+1)^2

        Так как $n \geq 2$, то в левой части неравенства факториал как минимум содержит $4$ множителя:

        @math
            \ldots (n-1)\cdot n\cdot (n+1)\cdot (n+2) \ldots > n^2\cdot(n+1)^2

        Этой левой части нам не хватит.
        Сейчас она меньше правой.
        К счастью, мы можем подтащить $2!$ из самого первого множителя, так как соответствующий ему справа равен $1^2$ и никак ее не компенсирует:

        @math
            \ldots \textbf{2} \cdot (n-1)\cdot \cancel{n\cdot (n+1)}\cdot (n+2) \ldots > n^{\cancel{2}}\cdot(n+1)^{\cancel{2}}
            \\
            2\cdot(n^2 + 2n -n - 2) > n^2 + n
            \\
            2n^2 - n^2 + 4n - 2n - n - 4 > 0
            \\
            n^2 + n > 4

        Последнее верно, так как $n\geq 2$, а значит в худшем случае получится $6 > 4$.

        Итак, каждый множитель слева больше соответствующего ему множителя справа.
        А последний множитель слева вместе с $2$ из первого множителя оказываются больше, чем последний множитель справа вместе с добавкой $(n+1)^2$.

        $\blacksquare$

{ #zero-num }
@problems
    title: Поиск нулей факториала
    level: hard
    set:
        -   label: Образец
            description: |
                Сколько нулей в конце факториала $100$?\
                А у факториала $526$?\
                А у факториала $n$?
            hint: |
                Для получения $0$ в конце числа нужно, чтобы среди его множителей оказались числа $2$ и $5$.
                Так как среди множителей факториала четных чисел больше тех, что делятся на $5$, то про двойки можно забыть и нолей в конце у него будет ровно столько, сколько пятерок получится выделить из его множителей.
            solution:
                "": |
                    Как получить $0$ в конце числа?
                    Достаточно, чтобы среди его множителей оказались числа $2$ и $5$. При перемножении они дают $10$, нолик от которой идет в конец числа:

                    $$ 30 = 5\cdot 6 = \boxed{2\cdot 5} \cdot 3 \qquad 1100 = 11\cdot10\cdot 10 = 11\cdot \boxed{2\cdot 5} \cdot \boxed{2\cdot 5} $$

                    Распишем первые множители в факториале $100$:

                    $$ 100! = 1\cdot \textbf{2}\cdot 3\cdot \textbf{4}\cdot \boxed{5}\cdot \textbf{6}\cdot 7 \cdot \textbf{8} \cdot 9 \cdot \boxed{10} \ldots $$

                    В этой цепочке умножений мы видим, что между каждым числом, которое делится на $5$, то есть из него можно "вытащить" пятерку, всегда есть
                    два четных числа, из которых можно "вытащить" двойку.

                    Получается, "двоек" всегда больше "пятерок".
                    Недостатка двоек не возникнет.
                    Можно сконцентрироваться только на пятерках.
                    **У факториала будет столько нулей в конце, сколько пятерок мы сможем "вытащить" из его цепочки умножений.**

                    Найдем, сколько в $100!$ есть чисел, которые как минимум один раз делятся на $5$, то есть из них можно "вытащить" хотя бы одну пятерку:

                    $$ 5, \ 10, \ 15, \ 20, \ 25, \ \ldots $$

                    Можно не считать их вручную, а сразу найти количество:

                    $$ 100 : 5 = 20 $$

                    $20$ пятерок, а значит и $20$ нулей в конце факториала $100$ у нас уже есть.
                    Но это еще не все.
                    Среди множителей есть числа, в разложении которых есть сразу две пятерки: $25$, $50$, ...
                    Одну из этих пятерок мы уже вытащили выше, но надо учесть еще и вторую пятерку!
                    Найдем количество таких чисел, которые дважды можно разделить на $5$:

                    $$ 100 : 5 : 5 = 100 : 5^2 = 100 : 25 = 4 $$

                    Это еще $4$ неучтенные пятерки, что дает уже $20 + 4 = 24$ нуля в конце $100!$.

                    Среди множителей $100!$ нет чисел, которые в разложении дают сразу $3$ пятерки, потому что первое такое число равно $125$.

                    $$ 100 : 5 : 5 : 5 = 100 : 5^3 = 100 : 125 = 0.8 $$

                    Целая часть $\lfloor 0.8 \rfloor$ равна $0$.
                    Это и означает тот очевидный факт, что среди чисел от $1$ до $100$ нет таких, которые делятся на $5$ трижды.

                    Больше пятерок не осталось, мы выжали все.
                    На этом наша работа закончена. $100!$ имеет $24$ нуля в конце.

                "Общий случай": |
                    Если обобщить полученный нами алогритм, то для нахождения количества нулей в $n!$ надо выжать из него все пятерки.
                    Для этого мы делим $n$ на $5^1$, $5^2$, $5^3$ и так далее до тех пор, пока целая часть от деления не станет равна $0$.
                    Затем просто складываем полученные целые части:

                    $$ \left\lfloor \frac{n}{5^1} \right\rfloor  + \left\lfloor \frac{n}{5^2} \right\rfloor + \left\lfloor \frac{n}{5^3} \right\rfloor + \ \ldots $$

                    Найдем количество нулей в конце у $1234!$:

                    @math
                        \underbrace{\floor{\frac{526}{5}}}_{105} + \underbrace{\floor{\frac{526}{25}}}_{21} + \underbrace{\floor{\frac{526}{125}}}_{4} + \underbrace{\floor{\frac{526}{525}}}_{1} + \underbrace{\floor{\frac{526}{2625}}}_{0} = \\
                        = 105 + 21 + 4 + 1 = \boxed{131}
            answer: |
                У $100!$ в конце $24$ нуля.
                У $526!$ в конце $131$ ноль.

                В общем случае, для нахождения количества нулей в конце $n!$, надо последовательно складывать целые части от деления $n$ на степени $5$:

                $$ \left\lfloor \frac{n}{5^1} \right\rfloor  + \left\lfloor \frac{n}{5^2} \right\rfloor + \left\lfloor \frac{n}{5^3} \right\rfloor + \ \ldots $$

        -   generator: generators/zeroes-1
            description: Найдите количество нулей в конце ${{ n }}$.
            answer: |
                ${{ answer }}$

        -   generator: generators/zeroes-2
            description: |
                Найдите количество нулей в конце числа:

                {{ expression }}
            solution: |
                Если расписать факториалы по [определению](article|factorial), то это выражение окажется одной огромной цепочкой из множителей.
                Количество пятерок в ней будет определять количество нулей в конце.

                Но эта длинная цепочка состоит из повторяющихся сегментов -- факториалов числа {{ n }}.
                В этих повторяющихся сегментах одинаковое количество пятерок.

                Находим количество пятерок в одном сегменте и умножаем на количество сегментов -- {{ m }}.
            answer: |
                {{ answer }}

        -   generator: generators/zeroes-3
            description: |
                Найдите количество нулей в конце числа:

                {{ expression }}
            solution: |
                При делении одного числа на другое количество нулей сокращается:

                $$ \frac{1230\cancel{00}}{4\cancel{00}} = 1230 $$

                Было $3$ нуля сверху и $2$ снизу, остался только $3 - 2 = 1$.
                В общем случае, если у числа сверху $n$ нулей, а снизу $m$ нулей, то останется $n-m$ нулей.

                Далее, если число возводится в квадрат, то количество его нулей удваивается:

                $$ 10^2 = 10\cdot 10 = 100 \qquad 100^2 = 100\cdot 100 = 10000 \qquad \ldots $$

                Если же число возводится в куб, то количество нулей утраивается:

                $$ 10^3 = 10\cdot 10 \cdot 10 = 1000 \quad \ldots $$

                ---

                Для решения задачи надо найти количество нулей у факториала сверху.
                Потом найти нули факториала снизу и удвоить или утроить их, в зависимости от степени.
                Наконец, вычесть из верхних нулей нижние.
            answer: |
                {{ answer }}

@problem
    title: Поиск факториалов по нулям
    level: hard
    description: |
        Найдите все факториалы, в конце которых будет ровно $10$ нулей.\
        А какие имеют в конце ровно $11$ нулей?
    hint: |
        Перечисляйте факториалы всех чисел, которые делятся на $5$ и считайте количество добавляющихся в конце нулей.
    solution: |
        Первый ноль появляется у $5!$, потому что там впервые встречается $5$.
        Далее по одному нулю добавляется через каждые $5$ чисел:

        $$ 5!_1 \quad 10!_2 \quad 15!_3 \quad 20!_4 $$

        Факториал $25!$ добавляет сразу два нуля и будет добавлять так через каждые $25$ чисел:

        $$ 25!_6 \quad 30!_7 \quad 35!_8 \quad 40!_9 \quad 45!_{10} $$

        С этого момента все факториалы будут иметь $10$ нулей вплоть до $50!$, в котором добавится еще два нуля.
        Это и есть ответ на первый вопрос задачи:

        $$ 45!_{10} \quad 46!_{10} \quad 47!_{10} \quad 48!_{10} \quad 49!_{10} $$

        Факториал $50!$ добавит еще два нуля, что в сумме даст $12$.
        Не существует факториалов, которые имеют $11$ нулей.
    answer: |
        Факториалы с $10$ нулями в конце:

        $$ 45! \quad 46! \quad 47! \quad 48! \quad 49! $$

        Факториалов с $11$ нулями в конце не существует.

@problem
    title: Поиск множителей
    level: hard
    description: |
        Найдите такой наибольший показатель степени для числа $12^n$, чтобы оно нацело делило число $49!$.
    hint: |
        Алгоритм поиска количества множителей точно такой же, как и в [задаче](zero-num) про поиск нулей.
    solution: |
        Разложим $12$ на простые множители:

        $$ 12 = 3\cdot 2 \cdot 2 $$

        Итак, нам нужно найти все тройки в $49!$ и при этом убедиться, что нам хватит двоек для того, чтобы получить $12$.

        Сначала найдем все тройки в $49!$:

        $$ \floor{\frac{49}{3}} + \floor{\frac{49}{9}} + \floor{\frac{49}{27}} = 16 + 5 + 1 = 22 $$

        Это значит, что число $49!$ в теории может поделиться на $12^{22}$, если для каждой из этих $22$ троек мы найдем по две двойки.
        То есть нам нужно $44$ двойки.
        Найдем количество двоек в $49!$:

        @math
            \floor{\frac{49}{2}} + \floor{\frac{49}{4}} + \floor{\frac{49}{8}} + \floor{\frac{49}{16}} + \floor{\frac{49}{32}} = \\
            = 24 + 12 + 6 + 3 + 1 = 46

        Количество двоек еле-еле хватило, но все же хватило.
        Значит, $49!$ делится на $12^{22}$, а ответ задачи равен $22$.
    answer: |
        $n = 22$

{ #increasing-factorial link }
@problem
    title: Возрастающий факториал
    level: hard
    description: |
        Возрастающий факториал определяется следующим образом:

        $$ n^{\overline{k}} = n\cdot(n+1)\cdot \ldots \cdot (n+(k-1)) $$

        1. Найдите формулу $n^{\overline{k}}$ через обычный факториал.
        2. Выведите эту же формулу с помощью [формулы](article|falling-factorial-formula) убывающего факториала.
    hint: |
        В первом случае воспроизведите алгоритм доказательства [формулы](article|falling-factorial-formula) убвающего факториала.

        Во втором просто "переверните" возрастающий факториал. Так он превратиться в убывающий.
    solution:
        "Через обычный факториал": |

            Распишем возрастающий факториал по определению:

            $$ n^{\overline{k}} = n\cdot(n+1)\cdot \ldots \cdot (n+(k-1)) $$

            Допишем к этой цепочке слева множители с $1$ по $n-1$.
            Чтобы ничего не изменилось, на них же и разделим:

            $$ n^{\overline{k}} = \frac{ \textcolor{#bc8d3e}{1\cdot 2\cdot \ldots \cdot (n-1)} \cdot n \cdot (n+1) \cdot \ldots \cdot (n+(k-1)) }{ \textcolor{#bc8d3e}{1\cdot 2 \cdot \ldots \cdot (n-1)} } $$

            Сверху у нас получается факториал $n+k-1$, а снизу факториал $n-1$:

            $$ n^{\overline{k}} = \frac{(n+k-1)!}{(n-1)!} $$

        "Через убывающий факториал": |
            В возрастающем факториале $n^{\overline{k}}$ количество множителей равно $k$.
            Если его "перевернуть", то получится убывающий факториал с таким же количеством множителей.
            Начинаться он будет с конца, то есть с множителя $n+k-1$.
            Подставляем эти данные в формулу убывающего факториала:

            $$ n^{\overline{k}} = (n+k-1)^{\underline{k}} = \frac{(n+k-1)!}{\left((n+k-1) - k\right)!} = \frac{(n+k-1)!}{(n-1)!} $$
    answer: |
            $$ n^{\overline{k}} = \frac{(n+k-1)!}{(n-1)!} $$

@problem
    title: Полная разность факториалов
    level: hard
    description: |
        Чему равна разность $m! - n!$ двух произвольных чисел $m$ и $n$ при условии, что $m>n$?
    hint: |
        Обозначьте разность $m-n$ буквой $k$.

        Ход решения такой же, как и в [задаче](diff) про разность факториалов соседних чисел.
    solution: |
        Cначала найдем разницу между $m$ и $n$ и обозначим ее за $k$:

        $$ k = m - n $$

        Тогда разницу факториалов можно записать иначе:

        $$ m! - n! = (n + k)! - n! = \ldots $$

        Теперь последовательно применяем рекуррентную формулу факториала, пока $(n+k)!$ не превратится в $n!$:

        $$ \ldots = n!\cdot(n+1)\cdot(n+2)\cdot\ldots\cdot (n+k) - n! = \ldots $$

        Выносим за скобки $n!$, а цепочку умножений можно "упаковать" в возрастающий факториал:

        $$ \ldots = n! \cdot \left((n+1)^{\overline{k}} - 1\right) $$

        Убираем все промежуточные действия, заменяем $k$ обратно на $m-n$ и получаем итоговую формулу:

        $$ m! - n! = n!\cdot\left((n+1)^{\overline{m-n}} - 1\right) $$
    answer: |
        $$ n!\cdot\left((n+1)^{\overline{m-n}} - 1\right) $$

@problem
    title: Факторионы
    level: hard
    description: |
        Факторионами называют такие числа, которые равны сумме факториалов своих цифр:

        $$ 145 = 1! + 4! + 5! $$

        Бесконечно ли количество факторионов?
    hint: |
        Сравните минимальное $n$-значное число с максимальным числом, которое может получиться от суммы $n$ факторионов.
    solution: |
        Минимальное число из $3$ цифр это $100$.
        Из четрых цифр -- $1000$:

        $$ \underbrace{100}_{3 \ знака} = 10^2 \qquad \underbrace{1000}_{4 \ знака} = 10^3 $$

        Замечаем, что минимальное число из $n$ цифр это всегда $10^{n-1}$.

        С другой стороны, максимальное число, которое может дать сумма из $n$ факториалов, — это $n$ раз сложить $9!$:

        $$ \underbrace{9! + 9! + \ldots}_{n \ раз} = n\cdot 9! $$

        Если даже минимальное число из $n$ цифр ($10^{n-1}$) окажется больше, чем в теории может дать максимальная сумма из $n$ факториалов ($n\cdot 9!$), то факторионов для чисел из $n$ цифр не существует:

        $$ 10^{n-1} > n\cdot 9! $$

        На этом этапе кому-то уже может всё стать понятно.
        Слева у нас степенная функция, которая растёт быстрее линейной, поэтому наступит такой момент, когда левая часть станет больше правой.
        Впервые это случится при $n=8$.
        Впрочем, даже без этих знаний о функциях неравенство [можно доказать](growing).

        { #growing }
        @details
            Поделим обе части неравенства на $n$:

            $$ \frac{10^{n-1}}{n} > 9! $$

            Справа от знака неравенства у нас фиксированное число $9!$, которое не меняется:

            $$ \frac{10^{n-1}}{n} > 362 \ 880 $$

            Подставляя возрастающие значения $n$ в левую часть, замечаем, что значения там становятся всё больше и больше.
            Когда $n=8$, число слева впервые становится больше числа справа.

            Докажем теперь, что числа слева всегда только возрастают.
            Для этого сравним два последовательных результата при $n$ и $n+1$:

            @math
                \frac{10^n}{n+1} \quad ? \quad \frac{10^{n-1}}{n} \\
                n\cdot 10^n \quad ? \quad (n+1)\cdot 10^{n-1} \\
                10\cdot n\cdot \cancel{10^{n-1}} \quad ? \quad (n+1)\cdot \cancel{10^{n-1}} \\
                10n \quad > \quad n + 1

            Последнее очевидно выполняется, потому что какое бы натуральное $n$ мы ни подставили, увеличенное в $10$ раз оно будет больше, чем если к нему просто прибавить единицу.

            Возвращаемся по цепочке обратно и заменяем вопросительные знаки на $>$:

            $$ \frac{10^n}{n+1} > \frac{10^{n-1}}{n} $$

            ---

            Возвращаемся к исходному неравенству:

            $$ \frac{10^{n-1}}{n} > 9! $$

            Мы доказали, что числа слева постоянно увеличиваются с ростом $n$.
            Это означает, что после $n=8$ числа слева станут еще больше предыдущих, и уж тем более больше, чем $9!$.

            $\blacksquare$

        Получается, не существует факторионов из $8$ и более цифр.
        Это означает, что все существующие факторионы прячутся где-то среди чисел от $1$ до $9 \ 999 \ 999$.
        Найти их, кроме очевидных $1$ и $2$, можно при помощи [прямого перебора](page|article|~/brute-force) на компьютере.
    answer: |
        Количество факторионов конечно.\
        Не существует факторионов из $8$ и более цифр.\
        Это означает, что все существующие факторионы прячутся где-то среди чисел от $1$ до $9 \ 999 \ 999$.
    note: |
        Понятие "факторион" придумал в $1995$ году американский математик Клиффорд Пиковер, хотя задача с таким условием была известна и ранее.
        Всего существует $4$ факториона:

        @math
            \begin{align*}
                &1 = 1! \\
                &2 = 2! \\
                &145 = 1! + 4! + 5! \\
                &40585 = 4! + 0! + 5! + 8! + 5!
            \end{align*}

@todo
    title: Придумать задания с возр. и убв. факториалами!

@todo
    title: Добавить задачи с двойными факториалами!
    content: |
        Там красивые прямые формулы можно для четных и нечетных чисел.
        Да и примеры всякие есть.
